<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drop-Off Locations | NC Electronic Recycling</title>
  <meta name="description" content="Find NC Electronic Recycling drop-off locations across North Carolina. Safe and responsible electronics recycling for residents, businesses, and agencies." />
  <meta name="theme-color" content="#0B1F44" />
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />

  <style>
    .map-frame {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      width: 100%;
      height: 400px;
    }
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 18px;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
    }
    .card h3 { color: var(--blue); margin:.2rem 0 .4rem; }
    .loading { text-align:center; color:var(--muted); font-style:italic; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container bar">
      <a class="brand" href="/">
        <img src="A_logo_for_NC_Electronic_Recycling.png" alt="NC Electronic Recycling logo" />
        <span class="title">
          <strong>NC Electronic Recycling</strong>
          <span>Public Recycling Program</span>
        </span>
      </a>
      <nav class="primary">
        <a href="/services">Services</a>
        <a href="/how">How it Works</a>
        <a href="/accepted-items">Accepted Items</a>
        <a href="/locations" aria-current="page">Locations</a>
        <a href="/faq">FAQ</a>
        <a href="/contact">Contact</a>
      </nav>
      <button class="menu-btn" onclick="toggleMenu()">Menu</button>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="container">
      <div class="lead">
        <span class="badge">Find a Drop-Off</span>
        <h1>Recycling Locations Across North Carolina</h1>
        <p>Convenient sites where residents, businesses, and agencies can drop off electronics for secure recycling and certified data destruction.</p>
      </div>
    </div>
  </section>

  <main id="main">
    <!-- Map -->
    <section class="section">
      <div class="container">
        <h2>Interactive Map</h2>
        <p>Explore locations on the map or view the full list below.</p>
        <div id="map" class="map-frame"></div>
      </div>
    </section>

    <!-- Location Cards -->
    <section class="section">
      <div class="container">
        <h2>Our Facilities</h2>
        <div id="locations" class="cards">
          <p class="loading">Loading locations...</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="container foot-grid">
      <div>
        <h5>NC Electronic Recycling</h5>
        <p class="muted">A public recycling initiative supporting secure, responsible electronics recovery across North Carolina.</p>
      </div>
      <div>
        <h5>Programs</h5>
        <ul><li><a href="/residential">Residential</a></li><li><a href="/business">Business</a></li></ul>
      </div>
      <div>
        <h5>Resources</h5>
        <ul><li><a href="/accepted-items">Accepted Items</a></li><li><a href="/locations">Locations</a></li></ul>
      </div>
      <div>
        <h5>Policies</h5>
        <ul><li><a href="/privacy">Privacy</a></li><li><a href="/terms">Terms</a></li></ul>
      </div>
    </div>
    <div class="container sub">
      <span>Â© Copyright 2025 an initiative of TEK-PAK INC</span>
    </div>
  </footer>

  <!-- Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>

  <script>
    function toggleMenu(){
      const nav=document.getElementById('mobileNav');
      if(nav) nav.classList.toggle('hidden');
    }

    // Load CSV from published Google Sheet
    async function loadLocations(){
      const url = "https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?output=csv"; // replace with your sheet's CSV URL
      const container = document.getElementById("locations");
      try {
        const res = await fetch(url);
        const text = await res.text();
        const rows = text.trim().split("\n").map(r => r.split(","));
        const [header, ...data] = rows;
        container.innerHTML = "";
        const locs = [];
        data.forEach(row => {
          const obj = {};
          header.forEach((h, i) => obj[h.trim()] = row[i]);
          locs.push(obj);

          // build card
          const card = document.createElement("article");
          card.className = "card";
          card.innerHTML = `
            <h3>${obj.Name}</h3>
            <p>${obj.Address}<br>${obj.City}, ${obj.State} ${obj.Zip}</p>
            <p><strong>Hours:</strong> ${obj.Hours}</p>
            <p><strong>Phone:</strong> ${obj.Phone}</p>
          `;
          container.appendChild(card);
        });
        initMap(locs);
      } catch(err){
        container.innerHTML = "<p class='loading'>Could not load locations.</p>";
      }
    }

    // Initialize Google Map with pins
    function initMap(locs){
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 8,
        center: { lat: 35.8, lng: -79.0 } // NC center
      });
      locs.forEach(loc => {
        const lat = parseFloat(loc.Lat), lng = parseFloat(loc.Lng);
        if(!isNaN(lat) && !isNaN(lng)){
          const marker = new google.maps.Marker({
            position: { lat, lng },
            map,
            title: loc.Name
          });
          const info = new google.maps.InfoWindow({
            content: `<strong>${loc.Name}</strong><br>${loc.Address}, ${loc.City}, ${loc.State} ${loc.Zip}<br><em>${loc.Hours}</em>`
          });
          marker.addListener("click", () => info.open(map, marker));
        }
      });
    }

    loadLocations();
  </script>
</body>
</html>
